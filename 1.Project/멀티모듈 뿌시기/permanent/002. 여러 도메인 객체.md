### 값 객체
#### 값의 특징
우선, 값은 다음과 주요한 특징을 가진다는 점을 이해할 필요가 있다.
1. 값은 불변하다.
2. 값은 동등성(equality)을 비교할 수 있다.
#### 값 객체란?
값 객체는 이름 그대로 값과 유사한 불변성과 동등 비교 가능성을 지니는 객체로, 시스템 특유의 값을 표현하기 위해 정의하는 것으로 마치 프로그래밍 언어 상의 원시 데이터 타입과 유사한 역할을 수행한다. 
그러나 상대적으로 도메인을 표현하는 표현력이 빈약한 원시 데이터 타입에 비해 값 객체는 높은 표현력을 갖는 장점이 있다.
또한, **값 객체는 단순히 데이터를 정의하는 구조체에서 벗어나 관련된 독자적인 행위까지 정의할 수 있다**.
#### 값 객체 판별하기
도메인 개념을 표현하는 여러 도메인 모델 중 값 객체로 정의할만한 것은 어려운 일이나, 다음과 같은 판단 기준을 도입해볼 수 있다.
1. 임의의 개념에 어떠한 규칙이 존재하는가?
2. 임의의 개념이 낱개로 다루어져야 하는가?
이러한 조건을 모두 충족한다면 값 객체로 승격시킬 것을 고려할 수 있으며, 이렇듯 **반복적인 개발 과정에서 새로이 발견한 개념을 도메인 모델에 반영하는 것은 도메인 주도 개발의 주된 목적**이다.
---
### 엔티티
> [!hint] DDD에서의 엔티티
> 엔티티는 DB 테이블이나 ORM 등에서 사용되는 등 IT 분야의 주요한 단어이나, 도메인 주도 개발의 엔티티는 이들과는 사뭇 다른 의미를 갖는다.
#### 엔티티란?
> 엔티티는 값 객체와 함께 도메인 모델을 구현하는 주요한 도메인 객체를 지칭한다.

예를 들어, 어떠한 시스템의 사용자가 자신의 비밀번호를 변경한다고 해서 그 사용자가 대체되는 것은 아니다.
이렇듯 사용자라는 엔티티는 동일성(identity)을 기반으로 식별할 수 있다는 점에서 값 객체와는 차이를 보인다. **엔티티는 각 속성의 값이 아닌 동일성으로써 식별되므로, 내부적인 값이 변경되더라도 언제나 동일한 엔티티로 인식**될 수 있다. 다시 말해, 값은 불변적이나 엔티티는 가변적일 수 있다!
#### 엔티티와 생명주기
엔티티는 시스템 속에서 생명주기를 갖고 변화해나가며, 이 과정에서 도메인 규칙을 구현한 코드의 형태로서 도메인의 문제 해결에 크게 기여한다.
이렇듯 **생명주기와 연속성은 엔티티가 갖는 큰 특징이자, 값 객체와 구분하기 위한 기준**이 될 수 있다.

---
### 다시 도메인 객체
#### 자기 서술적인 코드
소프트웨어를 해설하기 위해 작성된 기능 명세는 큰 그림을 그리는 데에는 큰 도움이 되나, 세세한 부분까지 모두 파악하기에는 큰 도움이 되지 않는 경우가 많다. 즉, 개발자는 언제나 소프트웨어를 파악하기 위해 코드에 의존할 수 밖에 없다.
반면, 도메인 주도 개발 과정에서 도메인에서 발견된 모든 규칙은 도메인 모델을 거쳐 도메인 객체에 전달되므로 도메인 객체는 자신이 준수해야 할 규칙을 코드의 형태로 쉽게 전달하게 된다. 
#### 도메인 객체의 이점
엔티티와 값 객체와 같은, **도메인 모델을 나타내기 위한 도메인 객체는 자기 서술적인 코드를 캡슐화된 단위로 작성**하기에 변경이 간단하며, 이로 인해 소프트웨어의 품질과 유지보수성은 크게 높아질 수 있다.
즉, 양질의 도메인 객체를 정의하는 것은 최초 개발 시점보다는 향후 끝없이 이어질 유지보수 과정에서 큰 도움이 될 수 있다.
#### 값 객체와 엔티티
어떠한 개념은 시스템에 따라 값 객체도 될 수 있고, 엔티티가 될 수도 있다. 이렇듯 **실제로는 같은 대상이라도 대상이 처한 환경과 문맥에 따라 모델링 결과는 달라**질 수 있기에 소프트웨어의 종류에 따라 적절한 모델링 방식을 결정할 수 있어야 한다.

---
### 도메인 서비스란?
> 값 객체나 엔티티에 정의하기 어색하고 부자연스러운 규칙은 도메인 서비스에 정의해볼 수 있다.

도메인 규칙을 코드로 표현하는 경우, 값 객체나 엔티티만으로 모든 것을 표현하기 애매한 부분이 발생할 수 있다. 그러나 이를 해결하지 않고 억지로 값 객체 또는 엔티티에 기능을 구현할 경우, 객체의 책임이 왜곡되어 유지보수성은 떨어지게 된다.
**이러한 로직은 별도의 객체로 추출하는 것이 바람직하며, 도메인 서비스는 이렇듯 도메인의 어색함을 해결해주기 위한 서비스 역할을 담당**한다. 즉, 일반적인 도메인 서비스는 여러 객체를 가로지르는 로직을 처리한다.
#### 주의사항
> 행위가 빈약한 도메인 객체를 정의하는 것은 곧 절차적 프로그래밍으로 변질되기 쉽다.

도메인 서비스는 다른 도메인 객체에 정의하기 부자연스러운 처리를 담당하며, **그렇지 못할 경우 모든 도메인 규칙이 도메인 서비스에 구현되어 도메인 객체는 단순한 구조체로 전락**하게 될 수 있다.
이렇듯 모든 도메인 규칙이 도메인 서비스로 유출된 시스템은 도메인 객체로부터 유의미한 도메인 규칙을 발견할 수 없게 되며, 점진적으로 데이터와 행동이 단절되어 로직이 이곳 저곳에 흩어지게 된다.
때문에 어떠한 규칙을 값 객체나 엔티티 또는 도메인 서비스 중 어디에 구현할지 판단이 서질 않는 경우에는 우선은 도메인 객체를 활용하되, 반드시 어색한 경우에만 도메인 서비스를 고려하도록 한다.

#### 도메인 서비스와 애플리케이션 서비스
> 도메인 서비스는 도메인 규칙을 코드의 형태로 구현한다는 점에서 도메인 객체와 유사하다. 

반면, DB 등의 저장소는 본래 도메인에는 존재하지 않으며 순전히 소프트웨어의 개발을 위해 추가된 애플리케이션 자체의 관심사에 해당한다.
결국 **도메인 객체는 오로지 도메인 모델만을 표현해야 하며, 어떠한 처리를 서비스로 추출하는 과정에서는 해당 기능이 도메인에 기반하는지를 판단할 필요**가 있다. 도메인 서비스 중에는 인프라와 같은 세부적인 기술에 관계되지 않고 오로지 도메인 객체만을 다루는 것도 있으며, 오히려 이러한 서비스가 진정한 도메인 서비스로 취급될 수 있다.