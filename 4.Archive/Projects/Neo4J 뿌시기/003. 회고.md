#토이프로젝트 #graphfs

### 좋았던 것
> 궁금했던 GraphDB를 써볼 수 있었다!

기존에는 트리와 같은 계층형 구조를 갖는 기능 구현에 [클로저 패턴](https://onibmag.tistory.com/44)과 MySQL을 사용했다.
당시에도 대체제로 Neptune과 같은 GraphDB를 고려하지 않은 것은 아니었으나, 트랜잭션을 중요시하는 팀 특성 상 큰 이견 없이 사용 중이던 MySQL과 별개의 인프라를 두지 않고 개발하는 것으로 방향이 잡혔다.
그런데 이러한 방식은 계층형 구조가 조금만 복잡해지거나 구조 자체가 커지는 경우 아무래도 성능 저하가 눈에 띄게 느껴졌고, 당연스레 제품을 적극적으로 사용하는 사용자 경험에도 좋지 않은 영향을 줄 수 밖에 없었다.
제품의 전면적인 개편을 준비하는 현재로서는 해당 기능을 위해 GraphDB를 사용하자고 결정이된 것은 아니지만, 최소한 개인 시간을 내어 poc라도 진행하는 것이 팀 의사 결정에 도움이 될 것이라고 생각했기에 Neo4j를 활용한 GraphDB 헤딩을 시작하게 되었다.
결과는 나름 만족스럽다. Tinkerpop에 비해 Cypher가 쉽다고 들은 바와 같이 실제 체감 난이도 역시 어렵지 않았고, 원하는 대로 쿼리를 작성하기까지 긴 시간이 걸리지 않아 성취감도 빠르게 느껴졌다. 무엇보다 Spring 차원에서 Neo4j가 잘 정합되어 있으면서도 Reactive를 지원하는 점이 마음에 든다.

### 아쉬웠던 것
> 내가 제대로 사용한게 맞을까 확신이 들지 않는다...

관계형 DB와 비교했을 때 아무래도 GraphDB는 레퍼런스가 많지 않고, 믿을만한 개발 서적도 적어 내가 짠 쿼리가 안티 패턴인지, 그렇지 않은지 확실히 판단히 서지 않는 점은 무섭다. 실행 계획을 봐도 아직은 낯선 부분이 더 많고... 실무에서 적용하게 된다면 성능 최적화에 좀 더 많은 시간을 들여야하지 않을까 싶다.
덧붙이자면 만~약 실무에서 GraphDB를 채택하게 된다고 해도 관리형 서비스인 AWS Neptune을 사용하게 될텐데, Neptune이 Cypher를 지원한다고는 하지만 시간 관계상 대해 확실히 poc를 진행하지 못한 점도 영 찝찝하다.

### 추후에 해볼만한 것들
- 쿼리 실행 계획에 대해 철저한 이해를 기반으로 한 튜닝
- AWS Neptune에서도 잘 동작하는지 확인

### 총평
기존에 작업했던 기능에 GraphDB를 도입하여 개편한다고 할 경우, 해당 토이프로젝트를 진행하지 않았다면 약 한 달 정도 소요될 시간을 절반인 2주 정도로 줄일 수 있다는 자신이 붙었다! 이로 인해 이득 본 2주의 시간은 탄탄한 테스트 코드 작성과 성능 최적화에 들일 수 있도록 팀과 쇼부를 볼 수 있지 않을까? 🤗